<!DOCTYPE html>

<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="viewport" content="width=500">

    <title>Week 6</title>
    </head>

<body>

        <h1>Locations of All Users</h1>
        <script>
            getData();
            async function getData() {
                const response = await fetch('/api');
                const data = await response.json();

                for (item of data) {
                    const root = document.createElement('div')
                    const userName = document.createElement('div')
                    const geo = document.createElement('div')
                    const date = document.createElement('div')

                    userName.textContent = `userName: ${item.userName}`;
                    geo.textContent = `${item.lat}°, ${item.lon}°`;
                    const dateString = new Date(item.timestamp).toLocaleString();
                    date.textContent = dateString;

                    root.append(userName, geo, date);
                    document.body.append(root);
                }
                console.log(data);
            }
        </script>

        <script type = "redirect html">
            function Redirect() {
               window.location = "index.html";
            }            
        </script>

        <p>Click the following button, you will be redirected to home page.</p>
      
        <form>
            <input type = "button" value = "Homepage" onclick = "Redirect();" />
        </form>
        <br>
        <br>
        <br>

</body>
</html>